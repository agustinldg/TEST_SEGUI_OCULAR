<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galería de Animales</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Galería de Animales</h1>
        <div class="gallery">
            <div class="animal-card">
                <img src="https://images.unsplash.com/photo-1548247416-ec66f4900b2e?w=800&h=600&fit=crop" alt="León" class="animal-image">
                <div class="animal-info">
                    <h3>León</h3>
                    <p>El rey de la selva</p>
                </div>
            </div>
            
            <div class="animal-card">
                <img src="https://images.unsplash.com/photo-1517849845537-4d257902454a?w=800&h=600&fit=crop" alt="Elefante" class="animal-image">
                <div class="animal-info">
                    <h3>Elefante</h3>
                    <p>El gigante gentil</p>
                </div>
            </div>
            
            <div class="animal-card">
                <img src="https://images.unsplash.com/photo-1552410260-0fd9b577afa6?w=800&h=600&fit=crop" alt="Tigre" class="animal-image">
                <div class="animal-info">
                    <h3>Tigre</h3>
                    <p>El cazador sigiloso</p>
                </div>
            </div>
            
            <div class="animal-card">
                <img src="https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=800&h=600&fit=crop" alt="Águila" class="animal-image">
                <div class="animal-info">
                    <h3>Águila</h3>
                    <p>El señor del cielo</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Script cargado, buscando tarjetas...');
            const animalCards = document.querySelectorAll('.animal-card');
            console.log('Tarjetas encontradas:', animalCards.length);
            
            animalCards.forEach((card, index) => {
                console.log(`Configurando tarjeta ${index + 1}`);
                
                let hideTimeout; // Variable para el timeout de ocultación
                let animationFrame; // Variable para controlar la animación
                let isAnimating = false; // Flag para saber si está animando
                let currentProgress = 0; // Progreso actual de la animación
                
                card.addEventListener('mouseenter', function() {
                    // Cancelar cualquier timeout pendiente
                    if (hideTimeout) {
                        clearTimeout(hideTimeout);
                        hideTimeout = null;
                    }
                    
                    // Si ya está animando, no hacer nada
                    if (isAnimating) {
                        return;
                    }
                    
                    console.log(`Mouse enter en tarjeta ${index + 1} - progreso actual: ${currentProgress}`);
                    
                    // Obtener la posición exacta de la tarjeta
                    const rect = card.getBoundingClientRect();
                    
                    // Crear el marco con conic-gradient y mask
                    const border = document.createElement('div');
                    border.id = `border-${index}`;
                    border.style.position = 'fixed';
                    border.style.top = (rect.top - 10) + 'px';
                    border.style.left = (rect.left - 10) + 'px';
                    border.style.width = (rect.width + 20) + 'px';
                    border.style.height = (rect.height + 20) + 'px';
                    border.style.borderRadius = '25px';
                    border.style.zIndex = '9999';
                    border.style.pointerEvents = 'none';
                    border.style.background = 'conic-gradient(from 0deg, #ffffff 0deg, transparent 0deg)';
                    
                    // Crear máscara CSS para que solo se vea el borde
                    const outerRadius = 35;  // Aumenté el radio exterior
                    const innerRadius = 25;  // Aumenté el radio interior
                    const maskImage = `radial-gradient(circle at center, transparent ${innerRadius}px, black ${innerRadius}px, black ${outerRadius}px, transparent ${outerRadius}px)`;
                    
                    border.style.webkitMaskImage = maskImage;
                    border.style.maskImage = maskImage;
                    
                    document.body.appendChild(border);
                    
                    // Calcular el tiempo inicial basado en el progreso actual
                    let startTime = Date.now() - (currentProgress * 4000);
                    isAnimating = true;
                    
                    function animateConicBorder() {
                        if (!isAnimating) {
                            return; // Pausar la animación
                        }
                        
                        const elapsed = Date.now() - startTime;
                        const progress = Math.min(elapsed / 4000, 1);
                        currentProgress = progress;
                        
                        // Calcular el ángulo (0 a 360 grados)
                        const angle = progress * 360;
                        
                        // Cambiar color gradualmente de blanco a verde
                        const colorProgress = Math.min(progress * 1.5, 1);
                        const red = Math.floor(255 * (1 - colorProgress));
                        const green = Math.floor(76 + (179 - 76) * colorProgress);
                        const blue = Math.floor(255 * (1 - colorProgress));
                        const color = `rgb(${red}, ${green}, ${blue})`;
                        
                        // Aplicar el conic-gradient
                        border.style.background = `conic-gradient(from 0deg, ${color} 0deg, ${color} ${angle}deg, transparent ${angle}deg)`;
                        
                        if (progress < 1 && isAnimating) {
                            animationFrame = requestAnimationFrame(animateConicBorder);
                        } else {
                            isAnimating = false;
                            console.log(`Animación completada para tarjeta ${index + 1}`);
                        }
                    }
                    
                    animationFrame = requestAnimationFrame(animateConicBorder);
                });
                
                card.addEventListener('mouseleave', function() {
                    console.log(`Mouse leave en tarjeta ${index + 1} - pausando animación`);
                    
                    // Pausar la animación pero mantener el progreso actual
                    isAnimating = false;
                    if (animationFrame) {
                        cancelAnimationFrame(animationFrame);
                        animationFrame = null;
                    }
                    
                    // Crear timeout para remover el marco después de 2 segundos
                    hideTimeout = setTimeout(function() {
                        console.log(`Removiendo marco de tarjeta ${index + 1} después del delay`);
                        
                        // Remover el marco
                        const border = document.getElementById(`border-${index}`);
                        if (border) {
                            border.remove();
                        }
                        
                        hideTimeout = null;
                        currentProgress = 0; // Resetear el progreso
                    }, 2000); // 2 segundos de delay
                });
            });
        });
    </script>
</body>
</html>
